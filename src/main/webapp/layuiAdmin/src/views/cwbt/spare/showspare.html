
<html>
<head>
<meta charset="utf-8">
	<title>查看备件（二级）</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="stylesheet" href="/layui/layui/css/layui.css" medidia="all" />
	<link rel="stylesheet" href="/layui/css/news.css" media="all" />
	<link rel="stylesheet" href="/layui/css/common.css" media="all" />
	<link rel="stylesheet" href="/layui/layui/css/change.css" medidia="all" />
	<style>
		#layui-table-page1{text-align:center;}
		.layui-table-view {border-top-left-radius: 0px;border-top-right-radius: 0px;}
	</style>
</head>
<body  style="width:100%;height:100%">
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
			  <legend>备件基本信息</legend>
	</fieldset>
<form class="layui-form" action="" onsubmit="return false">
<div id="wraper">
<div style="margin-left: 10%;">


			<div class="layui-form-item">
			    <div class="layui-inline">
			      <label class="layui-form-label label-width" style="width: 90px;">备件编码</label>
			      <div class="layui-input-inline">
			        <input type="text" name="code" id="code" :value="wcSpare.code"  autocomplete="off" class="layui-input"  disabled="disabled" >
			      </div>
			    </div>
			
			</div>
			
			<div class="layui-form-item">
			
		    <div class="layui-inline">
		      <label class="layui-form-label label-width" style="width: 90px;">名称</label>
		      <div class="layui-input-inline">
		        <input type="text" name="name" class="layui-input" id="name" :value="wcSpare.name"  autocomplete="off"  disabled="disabled">
		      </div>
		    </div>
		    <div class="layui-inline">
		      <label class="layui-form-label label-width" style="width: 90px;">原编码</label>
		      <div class="layui-input-inline">
		        <input type="text" name="sourceCode" id="sourceCode" :value="wcSpare.sourceCode"  autocomplete="off" class="layui-input" disabled="disabled">
		      </div>
		    </div>
		    <div class="layui-inline">
		      <label class="layui-form-label label-width" style="width: 90px;">规格型号</label>
		      <div class="layui-input-inline">
		        <input type="text" name="model" id="model"  :value="wcSpare.model" autocomplete="off" class="layui-input" disabled="disabled">
		      </div>
		    </div>
		  </div>
		  <div class="layui-form-item">
		    <div class="layui-inline">
		      <label class="layui-form-label label-width" style="width: 90px;">厂家</label>
		      <div class="layui-input-inline">
		        <input type="text" name="manufactor" id="manufactor"   :value="wcSpare.manufactor" class="layui-input" disabled="disabled">
		      </div>
		    </div>
		   <div class="layui-inline">
		      <label class="layui-form-label label-width" style="width: 90px;">所属部门</label>
		     <div class="layui-input-inline">
		    	<input type="text" id="department" name="departmentname" :value="wcSpare.departmentname" class="layui-input" disabled="disabled">
		    </div>
		    </div>
		    <div class="layui-inline">
			      <label class="layui-form-label label-width" style="width: 90px;">仓库级别</label>
			      <div class="layui-input-inline">
			    	<input type="text" name="levelname" id="levelname"   :value="wcSpare.levelname"  class="layui-input" disabled="disabled"> 
			      </div>
			    </div> 
		    
		   </div>
		 
		  <div class="layui-form-item" >
			  <div class="layui-inline">
			      <label class="layui-form-label label-width" style="width: 90px;">技术属性</label>
			      <div class="layui-input-inline">
			    	<input type="text" name="skillAttributename" id="skillAttributename"   :value="wcSpare.skillAttributename"  class="layui-input" disabled="disabled">   
			      </div>
			    </div> 
			    <div class="layui-inline">
			      <label class="layui-form-label label-width" style="width: 90px;">特殊属性</label>
			      <div class="layui-input-inline">
			    	<input type="text" name="specialAttributename" id="specialAttributename"   :value="wcSpare.specialAttributename"  class="layui-input" disabled="disabled"> 
			      </div>
			    </div> 
			    <div class="layui-inline">
			      <label class="layui-form-label label-width" style="width: 90px;">专业属性</label>
			      <div class="layui-input-inline">
			    	<input type="text" name="majorAttributename" id="majorAttributename"   :value="wcSpare.majorAttributename"  class="layui-input" disabled="disabled">
			      </div>
			    </div>
		  </div>
		  <div class="layui-form-item" >
		  <div class="layui-inline">
		      <label class="layui-form-label label-width" style="width: 90px;">备注</label>
		      <div class="layui-input-inline">
		        <textarea  class="layui-textarea" name="remarks" :value="wcSpare.remarks" id="remarks" style="width:500px" disabled="disabled"></textarea>
		      </div>
		    </div>
		  </div>
		  
	</div>
	<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
			  <legend>计量</legend>
	</fieldset>	
<div style="margin-left: 10%;">
	<div class="layui-form-item" >
		<div class="layui-inline">
			<label class="layui-form-label label-width" style="width: 90px;">数量</label>
		      <div class="layui-input-inline">
		        <input type="text" name="number" id="number"  autocomplete="off" :value="wcSpare.number" class="layui-input" disabled="disabled">
		      </div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label label-width" style="width: 90px;">单位</label>
		      <div class="layui-input-inline">
		        <input type="text" name="unitname" id="unitname"  autocomplete="off" :value="wcSpare.unitname" class="layui-input" disabled="disabled">
		      </div>
		</div>
	</div>
</div>	

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
		<legend>预警设置</legend>
</fieldset>	
<div style="margin-left: 10%;">
	<div class="layui-form-item" >
		<div class="layui-inline">
			<label class="layui-form-label label-width" style="width: 90px;">预警数量</label>
		      <div class="layui-input-inline">
		        <input type="text" name="alertnumber" id="alertnumber" :value="wcSpare.alertnumber" autocomplete="off" value="0" class="layui-input" lay-verify="require|double">
		      </div>
		</div>
	</div>
</div>
	 
</div>

	<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
			  <legend>库存记录</legend>
	</fieldset>	
		
<div id="div1" style="margin-left: 10%;">
	
</div>
</form>
	
	<script src="/layui/layui/layui.all.js" charset="utf-8"></script>
	<script type="text/javascript" src="/layui/js/dataSelect.js"></script>
	<script type="text/javascript" src="/layuiAdmin/src/views/cwbt/js/layer.js"></script>
	<script type="text/javascript" src="/jquery-3.3.1/jquery-3.3.1/jquery-3.3.1.js"></script>
	<script src="/layuiAdmin/src/views/cwbt/js/vue.min.js"></script>
	<script>
	var table;
	var layer;
	var laytpl;
	var dataTable;
	var laydate;
	var form;
	var $;
	var loading;
	var treeSelect; 
	var json = [];
	var id = sessionStorage.id;
	sessionStorage.setItem("id",null);//清空
	
	 var vue = new Vue({
			el: "#wraper",
			data: {
				wcSpare:{}
			},
	  });
	
	layui.use(['table','form','layer','laytpl','laydate','treeSelect'], function(){
	  table = layui.table,
	  layer = layui.layer,
	  loading = layer.load(1, {
    	  shade: [0.5,'#000'] //0.1透明度的白色背景
	    });
	  laytpl = layui.laytpl;
	  treeSelect= layui.treeSelect;
	  laydate = layui.laydate;
	  $ = layui.jquery;
		 $(document).ajaxStop(function (){
			 layer.close(loading);
			 
		 });
	 
	 form=layui.form,
	 
	 Window.onload=falst();
	 
	 form.verify({
         
		    double: function(value){
		    if(/^\d+$/.test(value)==false && /^\d+\.\d+$/.test(value)==false)
		    {
		     return '您输入的不是数字';
		    }
		   }
		});
	 
	});
	

	 
	//查询备件
	  function falst(){
		  $.ajax({
				url: "/wcSpare/selectbyid",
				type: "post",
				data: {
					id: id
				},
				dataType: "json",
				success: function (res) {
					vue.wcSpare = res;
					form.render(); 
					timelineshow();
				}
				
			}); 
	  }
	

	//时间格式处理（时间戳转字符串）
	  function createTime(v){
			var date = new Date(v);
		    var y = date.getFullYear();
		    var m = date.getMonth()+1;
		    m = m<10?'0'+m:m;
		    var d = date.getDate();
		    d = d<10?("0"+d):d;
		    var h = date.getHours();
		    h = h<10?("0"+h):h;
		    var ms = date.getMinutes();
		    ms = ms<10?("0"+ms):ms;
		    var s = date.getSeconds();
		    s = s<10?("0"+s):s;
		    var str = y+"-"+m+"-"+d+" "+h+":"+ms+":"+s;
		    return str;
		}
	
		 function timelineshow(){
			 $.ajax({
					url: "/wcSpare/intoandout",
					type: "post",
					data: {
						id: id
					},
					dataType: "json",
					success: function (res) {
						if(res.SUCCESS===true){

							var list = res.data;
							
							var uls = "<ul class=\"layui-timeline\">";
							var uls2 = "</ul>";
							var lis = "<li class=\"layui-timeline-item\">";
							var lis2 = "</li>";
							var is = "<i class=\"layui-icon layui-timeline-axis\"></i>";
							var divs = "<div class=\"layui-timeline-content layui-text\">";
							var divs2 = "</div>";
							var h3s = "<h3 class=\"layui-timeline-title\">";
							var h3s2 = "</h3>";
							var ps = "<p>";
							var ps2 = "</p>";
							var br = "</br>";
							
							var t1 = "时间:";
							var t2 = "状态:";
							var t3 = "数量:";
							var t4 = "备注:";
							var t5 = "负责人:";
							
							if(list.length>0){
								var content1 = "";
								content1 = content1+uls;
								for(var i=0; i<list.length; i++){
									var content2 = "";
									content2 = content2+lis+is+divs;
									if(list[i].time!=null&&list[i].time!=''){
										content2 = content2+h3s+t1+createTime(list[i].time)+h3s2
									}
									if(list[i].type!=null&&list[i].type!=''){
										content2 = content2+ps+t2+list[i].type+ps2;
									}
									if(list[i].username!=null&&list[i].username!=''){
										content2 = content2+ps+t5+list[i].username+ps2;
									}
									if(list[i].number!=null&&list[i].number!=''){
										content2 = content2+ps+t3+list[i].number+ps2;
									}
									if(list[i].remark!=null&&list[i].remark!=''){
										content2 = content2+ps+t4+list[i].remark+ps2;
									}
									
									//可扩展
									content2 = content2 + divs2+lis2;
									content1 =content1+content2;
								}
								content1 = content1 +uls2;

								//再跟你想追加的代码加到一起插入div中
								document.getElementById("div1").innerHTML = content1;
							}
						}else if(res.SUCCESS===false){
							layer.msg(res.msg);
						}
					}
					
				}); 
		 }
	
		 
		</script>
	
<style>
	.layui-layer-title{background: #fff;border: 1px solid #e5e5e5;border-top-left-radius: 4px;border-top-right-radius: 4px;font-size: 18px;}
</style>

</body>
</html>